{% from "macros/table.html" import table %}
{% from "macros/pagination.html" import pagination %}
{% from "macros/modal.html" import modal_shell %}

{# Pagination component #}
{{ pagination(
    current_page=current_page,
    total_pages=total_pages,
    items_per_page=items_per_page,
    total_items=total_users,
    base_url="/api/v1/users?page="
) }}

{# Table component #}
{{ table("users-table", rows, titles) }}

{# Pagination component #}
{{ pagination(
    current_page=current_page,
    total_pages=total_pages,
    items_per_page=items_per_page,
    total_items=total_users,
    base_url="/api/v1/users?page="
) }}

{# Modal definitions #}
{% for user in users %}
    {% set trigger_id="user-" ~ user.id ~ "-modal" %}

    {% set trigger_html %}
    <span id="{{ trigger_id }}" class="hidden"></span>
    {% endset %}

    {% set content_html %}
    <div class="user-details">
        <p><strong>ID:</strong> {{ user.id }}</p>
        <p><strong>Username:</strong> {{ user.username }}</p>
        <p><strong>Name:</strong> 
            {{ user.first_name }} 
            {% if user.middle_name %}{{ user.middle_name }} {% endif %}
            {{ user.last_name }}
        </p>
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>Admin:</strong> {% if user.is_admin %}Yes{% else %}No{% endif %}</p>
        <!-- Add more user details as needed -->
    </div>
    {% endset %}

    {% set footer_html %}
    <button class="btn" @click="open = false">Close</button>
    <button class="btn btn-primary">Edit User</button>
    {% endset %}

    {{ modal_shell(
        id='user-modal-' ~ user.id, 
        trigger_html=trigger_html, 
        title='User Details: ' ~ user.username, 
        content_html=content_html,
        footer_html=footer_html,
        size='md'
    ) }}
{% endfor %}
